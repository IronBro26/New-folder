<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>IronBro26 Members Area</title>
<style>
:root {
  --bg: #0a0a0a;
  --text: #fff;
  --accent: #ff1a1a;
  --accent-light: #ff6666;
  --success: #4caf50;
  --error: #ff4d4d;
}
*{box-sizing:border-box;margin:0;padding:0;}
body{background:var(--bg);color:var(--text);font-family:Arial,sans-serif;display:flex;justify-content:center;align-items:center;min-height:100vh;padding:20px;}
.container{background:rgba(255,26,26,0.05);padding:30px;border-radius:16px;width:100%;max-width:400px;text-align:center;border:1px solid rgba(255,255,255,0.1);}
input{display:block;width:100%;padding:10px;margin:10px auto;border-radius:8px;border:1px solid rgba(255,255,255,0.2);background:rgba(255,255,255,0.05);color:var(--text);}
button{padding:10px 20px;margin:10px 0;border:none;border-radius:8px;background-color:var(--accent);color:#fff;cursor:pointer;}
button:hover{background-color:var(--accent-light);}
.hidden{display:none;}
.alert{padding:10px;margin:10px 0;border-radius:8px;}
.alert-error{background:rgba(255,77,77,0.15);color:var(--error);}
.alert-success{background:rgba(76,175,80,0.15);color:var(--success);}
#onlineUsers{font-size:12px;color:#aaa;margin-top:10px;}
</style>
</head>
<body>
<div class="container">
<h1>IronBro26 Members Area</h1>
<div id="alertBox"></div>

<!-- Signup -->
<div id="signupDiv">
  <h2>Create Account</h2>
  <input type="email" id="signupEmail" placeholder="Email">
  <input type="password" id="signupPassword" placeholder="Password">
  <button onclick="signup()">Sign Up</button>
  <p>Already have an account? <a href="#" onclick="showLogin(); return false;">Log In</a></p>
</div>

<!-- Login -->
<div id="loginDiv" class="hidden">
  <h2>Login</h2>
  <input type="email" id="loginEmail" placeholder="Email">
  <input type="password" id="loginPassword" placeholder="Password">
  <button onclick="login()">Log In</button>
  <p>Don't have an account? <a href="#" onclick="showSignup(); return false;">Sign Up</a></p>
</div>

<!-- Member/Admin Area -->
<div id="membersDiv" class="hidden">
  <h2>Welcome, <span id="userEmail"></span>!</h2>
  <p>Role: <span id="userRole"></span></p>
  <button onclick="goToWebsite()">Go to Website</button>
  <button onclick="logout()">Log Out</button>

  <!-- Admin Panel -->
  <div id="adminPanel" class="hidden" style="margin-top:20px;text-align:left;">
    <h3>ðŸ›¡ Admin Panel</h3>
    <table border="1" cellspacing="0" cellpadding="6" style="width:100%;border-collapse:collapse;color:#fff;">
      <thead>
        <tr style="background:#ff1a1a;color:#000;">
          <th>Email</th>
          <th>Signed Up At</th>
          <th>Status</th>
        </tr>
      </thead>
      <tbody id="usersTable"></tbody>
    </table>
  </div>

  <div id="onlineUsers"></div>
</div>
</div>

<script>
// CONFIG
const OWNER_EMAIL = "krfuchs11@icloud.com";
const ONLINE_TIMEOUT = 5*60*1000; // 5 min

// STATE
let users = JSON.parse(localStorage.getItem('users')) || [];
let currentUser = JSON.parse(localStorage.getItem('currentUser')) || null;

// Show/Hide Divs
function showSignup(){
  document.getElementById('signupDiv').classList.remove('hidden');
  document.getElementById('loginDiv').classList.add('hidden');
  document.getElementById('membersDiv').classList.add('hidden');
}
function showLogin(){
  document.getElementById('signupDiv').classList.add('hidden');
  document.getElementById('loginDiv').classList.remove('hidden');
  document.getElementById('membersDiv').classList.add('hidden');
}

// Alerts
function showAlert(message,type='error'){
  const box=document.getElementById('alertBox');
  box.innerHTML=`<div class="alert alert-${type}">${message}</div>`;
  setTimeout(()=>{box.innerHTML='';},4000);
}

// SIGNUP
function signup(){
  const email=document.getElementById('signupEmail').value.trim().toLowerCase();
  const password=document.getElementById('signupPassword').value.trim();
  if(!email||!password){showAlert('Fill all fields');return;}
  if(users.find(u=>u.email===email)){showAlert('Email already exists');return;}

  const role=(email===OWNER_EMAIL)?'owner':'user';
  const now=Date.now();

  const newUser={email,password,role,signedUpAt:now,lastActive:now};
  users.push(newUser);
  localStorage.setItem('users',JSON.stringify(users));
  showAlert('Account created successfully','success');
  showLogin();
  updateAdminPanel();
}

// LOGIN
function login(){
  const email=document.getElementById('loginEmail').value.trim().toLowerCase();
  const password=document.getElementById('loginPassword').value.trim();
  const user=users.find(u=>u.email===email && u.password===password);
  if(!user){showAlert('Invalid email or password');return;}

  currentUser=user;
  currentUser.lastActive=Date.now();
  localStorage.setItem('currentUser',JSON.stringify(currentUser));
  localStorage.setItem('users',JSON.stringify(users));
  displayMemberArea();
}

// LOGOUT
function logout(){
  currentUser=null;
  localStorage.removeItem('currentUser');
  showLogin();
  showAlert('Logged out','success');
}

// DISPLAY MEMBER AREA
function displayMemberArea(){
  if(!currentUser)return;
  document.getElementById('userEmail').textContent=currentUser.email;
  document.getElementById('userRole').textContent=(currentUser.role==='owner')?'Admin':'Member';
  document.getElementById('signupDiv').classList.add('hidden');
  document.getElementById('loginDiv').classList.add('hidden');
  document.getElementById('membersDiv').classList.remove('hidden');
  updateOnlineUsers();

  if(currentUser.role==='owner'){
    document.getElementById('adminPanel').classList.remove('hidden');
    updateAdminPanel();
  }
}

// UPDATE ONLINE USERS
function updateOnlineUsers(){
  const now=Date.now();
  const onlineUsers=users.filter(u=>now-u.lastActive<ONLINE_TIMEOUT);
  document.getElementById('onlineUsers').textContent=
    onlineUsers.length?"Online: "+onlineUsers.map(u=>u.email).join(", "):"No users online";
}

// ADMIN PANEL
function updateAdminPanel(){
  const tbody=document.getElementById('usersTable');
  tbody.innerHTML='';
  const now=Date.now();
  users.forEach(u=>{
    const tr=document.createElement('tr');
    const emailTd=document.createElement('td'); emailTd.textContent=u.email;
    const timeTd=document.createElement('td'); timeTd.textContent=new Date(u.signedUpAt).toLocaleString();
    const statusTd=document.createElement('td');
    const isOnline=(now-u.lastActive<ONLINE_TIMEOUT);
    const statusBtn=document.createElement('button');
    statusBtn.textContent=isOnline?'Online':'Offline';
    statusBtn.style.background=isOnline?'#4caf50':'#ff4d4d';
    statusBtn.style.color='#000';
    statusTd.appendChild(statusBtn);
    tr.appendChild(emailTd);
    tr.appendChild(timeTd);
    tr.appendChild(statusTd);
    tbody.appendChild(tr);
  });
}

// GO TO WEBSITE
function goToWebsite(){window.location.href='index.html';}

// AUTO-LOGIN
window.onload=()=>{
  if(currentUser) displayMemberArea(); else showSignup();
};

// UPDATE ACTIVITY EVERY 30s
setInterval(()=>{
  if(currentUser){
    currentUser.lastActive=Date.now();
    localStorage.setItem('currentUser',JSON.stringify(currentUser));
    localStorage.setItem('users',JSON.stringify(users));
    updateOnlineUsers();
    if(currentUser.role==='owner') updateAdminPanel();
  }
},30000);
</script>
</body>
</html>
