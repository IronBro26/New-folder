<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Panel - IronBro26</title>
<style>
body{background:#0a0a0a;color:#fff;font-family:Arial,sans-serif;padding:20px;}
h1{color:#ff1a1a;text-shadow:0 0 10px #ff3333;}
table{width:100%;border-collapse:collapse;margin-top:20px;}
th,td{padding:10px;border:1px solid #ff1a1a;text-align:left;}
th{background:#ff1a1a;color:#000;}
td{background:#222;}
.status{width:20px;height:20px;border-radius:50%;display:inline-block;}
</style>
</head>
<body>
<h1>ðŸ›¡ IronBro26 Admin Panel</h1>
<p>Only admin can access this panel</p>

<table id="usersTable">
<tr><th>Email</th><th>Signup Time</th><th>Status</th></tr>
</table>

<script>
const ADMIN_EMAIL="krfuchs11@icloud.com";
const ONLINE_TIMEOUT=5*60*1000;

let currentUser=JSON.parse(localStorage.getItem('currentUser'));
if(!currentUser || currentUser.email!==ADMIN_EMAIL){ alert("Access denied!"); document.body.innerHTML="<h1>Access Denied</h1>"; }

function loadUsers(){
  const users=JSON.parse(localStorage.getItem('users')||'[]');
  const table=document.getElementById('usersTable');
  table.innerHTML=`<tr><th>Email</th><th>Signup Time</th><th>Status</th></tr>`;
  const now=Date.now();
  users.forEach(user=>{
    const row=table.insertRow();
    row.insertCell(0).innerText=user.email;
    row.insertCell(1).innerText=user.signupTime||new Date(user.lastActive).toLocaleString();
    const statusCell=row.insertCell(2);
    const dot=document.createElement('span');
    dot.className='status';
    dot.style.background=(now-(user.lastActive||0)<ONLINE_TIMEOUT)?'green':'red';
    statusCell.appendChild(dot);
  });
}

// Update table every 10s
setInterval(loadUsers,10000);

// Update on storage event (signup/login)
window.addEventListener('storage',e=>{
  if(e.key==='usersUpdate'){ loadUsers(); }
});

loadUsers();
</script>
</body>
</html>
