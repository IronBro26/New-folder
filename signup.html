<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>IronBro26 - Signup/Login</title>
<style>
body {
    font-family: Arial, sans-serif;
    background:#111;
    color:#fff;
    padding:20px;
}

h1 { text-align:center; color:#ff1a1a; margin-bottom:30px; }
h2 { color:#ff1a1a; font-size:18px; margin:15px 0 5px; }

form {
    margin-bottom:20px;
    max-width:300px;
    margin-left:auto;
    margin-right:auto;
}

input {
    padding:8px;
    margin:4px 0;
    width:100%;
    font-size:14px;
    border:1px solid #ff1a1a;
    border-radius:4px;
    background:#222;
    color:#fff;
}

button {
    padding:8px;
    margin:5px 0;
    width:100%;
    font-size:14px;
    background:#ff1a1a;
    color:#fff;
    border:none;
    border-radius:4px;
    cursor:pointer;
}

button:hover { background:#ff3333; }
</style>
</head>
<body>

<h1>IronBro26</h1>

<!-- Signup Form -->
<h2>Sign Up</h2>
<form id="signupForm">
    <input type="email" id="signupEmail" placeholder="Email" required />
    <input type="password" id="signupPassword" placeholder="Password" required />
    <button type="submit">Sign Up</button>
</form>

<!-- Login Form -->
<h2>Login</h2>
<form id="loginForm">
    <input type="email" id="loginEmail" placeholder="Email" required />
    <input type="password" id="loginPassword" placeholder="Password" required />
    <button type="submit">Login</button>
</form>

<script>
// COMMON FUNCTION TO GET USERS
function getUsers() {
    return JSON.parse(localStorage.getItem('users') || '[]');
}

// SIGNUP
document.getElementById('signupForm').addEventListener('submit', function(e){
    e.preventDefault();
    const email = document.getElementById('signupEmail').value.trim();
    const password = document.getElementById('signupPassword').value.trim();

    if(!email || !password){
        alert("Enter both email and password.");
        return;
    }

    let users = getUsers();

    if(users.some(u => u.email === email)){
        alert("Email already registered.");
        return;
    }

    const now = Date.now();
    const newUser = {
        email: email,
        password: password,
        signupTime: new Date(now).toISOString(),
        lastActive: now
    };

    users.push(newUser);
    localStorage.setItem('users', JSON.stringify(users));
    localStorage.setItem('currentUser', JSON.stringify(newUser));

    alert("Signup successful! You can now log in.");
    document.getElementById('signupForm').reset();
});

// LOGIN
document.getElementById('loginForm').addEventListener('submit', function(e){
    e.preventDefault();
    const email = document.getElementById('loginEmail').value.trim();
    const password = document.getElementById('loginPassword').value.trim();

    let users = getUsers();
    let user = users.find(u => u.email === email && u.password === password);

    if(!user){
        alert("Invalid credentials!");
        return;
    }

    // Update lastActive
    user.lastActive = Date.now();
    localStorage.setItem('currentUser', JSON.stringify(user));

    // Save updated user in users array
    const index = users.findIndex(u => u.email === email);
    users[index] = user;
    localStorage.setItem('users', JSON.stringify(users));

    alert("Login successful!");

    if(email === "krfuchs11@icloud.com"){
        window.location.href = "admin.html";
    } else {
        alert("You are logged in, but not admin.");
    }

    document.getElementById('loginForm').reset();
});
</script>

</body>
</html>
