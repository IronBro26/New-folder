<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NEON SIGNUP PORTAL</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
<style>
body {
  background: #000;
  color: #ff0033;
  font-family: 'Orbitron', sans-serif;
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
}
.container {
  text-align: center;
  border: 2px solid #ff0033;
  padding: 40px;
  border-radius: 12px;
  box-shadow: 0 0 20px #ff0033, 0 0 40px #ff0033 inset;
}
h1 {
  font-size: 2em;
  text-shadow: 0 0 5px #ff0033, 0 0 20px #ff0033;
  animation: pulse 2s infinite;
}
@keyframes pulse {
  0%,100% { text-shadow: 0 0 5px #ff0033, 0 0 20px #ff0033; }
  50% { text-shadow: 0 0 15px #ff0033, 0 0 30px #ff0033; }
}
input {
  padding: 10px;
  margin: 10px;
  border: 1px solid #ff0033;
  border-radius: 5px;
  background: transparent;
  color: #ff0033;
  box-shadow: 0 0 5px #ff0033;
}
button {
  padding: 10px 20px;
  margin: 10px;
  border: 1px solid #ff0033;
  border-radius: 5px;
  background: transparent;
  color: #ff0033;
  cursor: pointer;
  font-weight: bold;
  text-transform: uppercase;
  box-shadow: 0 0 5px #ff0033;
  transition: 0.3s ease-in-out;
}
button:hover { box-shadow: 0 0 20px #ff0033,0 0 40px #ff0033 inset; }
</style>
</head>
<body>
<div class="container">
  <h1>NEON SIGNUP PORTAL</h1>
  <form id="signup-form">
    <input type="email" id="email" placeholder="Email" required><br>
    <input type="password" id="passcode" placeholder="Passcode" required><br>
    <button type="submit">Sign Up</button>
  </form>
  <form id="login-form" style="display:none;">
    <input type="email" id="login-email" placeholder="Email" required><br>
    <input type="password" id="login-passcode" placeholder="Passcode" required><br>
    <button type="submit">Login</button>
  </form>
  <button id="toggle-login" style="margin-top:20px;">Switch to Login</button>
</div>

<script type="module">
import { auth, db } from "./firebase.js";
import { createUserWithEmailAndPassword, signInWithEmailAndPassword } from "firebase/auth";
import { doc, setDoc, serverTimestamp } from "firebase/firestore";

const toggleBtn = document.getElementById("toggle-login");
const signupForm = document.getElementById("signup-form");
const loginForm = document.getElementById("login-form");

toggleBtn.addEventListener("click", () => {
  if(signupForm.style.display === "none") {
    signupForm.style.display = "block";
    loginForm.style.display = "none";
    toggleBtn.innerText = "Switch to Login";
  } else {
    signupForm.style.display = "none";
    loginForm.style.display = "block";
    toggleBtn.innerText = "Switch to Sign Up";
  }
});

// Signup
signupForm.addEventListener("submit", async (e) => {
  e.preventDefault();
  const email = document.getElementById("email").value;
  const passcode = document.getElementById("passcode").value;

  try {
    const userCredential = await createUserWithEmailAndPassword(auth, email, passcode);
    const user = userCredential.user;

    await setDoc(doc(db, "users", user.uid), {
      email,
      signupTime: serverTimestamp(),
      lastOnline: serverTimestamp(),
      online: true,
      role: email === "Krfuchs@icloud.com" ? "Owner" : "Member"
    });

    alert("Signup successful! Please login.");
    signupForm.style.display = "none";
    loginForm.style.display = "block";
    toggleBtn.innerText = "Switch to Sign Up";
  } catch(err) { alert(err.message); }
});

// Login
loginForm.addEventListener("submit", async (e) => {
  e.preventDefault();
  const email = document.getElementById("login-email").value;
  const passcode = document.getElementById("login-passcode").value;

  try {
    const userCredential = await signInWithEmailAndPassword(auth, email, passcode);
    const user = userCredential.user;

    await setDoc(doc(db, "users", user.uid), {
      lastOnline: serverTimestamp(),
      online: true
    }, { merge: true });

    localStorage.setItem("currentUser", JSON.stringify({ email: user.email }));

    if(email === "Krfuchs@icloud.com") window.location.href = "admin.html";
    else window.location.href = "file:///C:/Users/Krfuc/OneDrive/Website/New%20folder/index.html";

  } catch(err) { alert(err.message); }
});
</script>
</body>
</html>
