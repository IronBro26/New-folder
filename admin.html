<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ADMIN CONTROL PANEL â€” ironbro26fanclub</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Audiowide&display=swap" rel="stylesheet">
<style>
:root{--bg:#000;--neon:#ff0033;--neon-green:#00ff88;}
body{margin:0;font-family:'Orbitron',sans-serif;background:var(--bg);color:var(--neon);}
h1{font-family:'Audiowide',sans-serif;font-size:36px;text-align:center;text-shadow:0 0 12px rgba(255,0,51,0.9),0 0 40px rgba(255,0,51,0.14);animation:pulse 2s infinite;}
@keyframes pulse{0%{text-shadow:0 0 6px rgba(255,0,51,0.5);}50%{text-shadow:0 0 22px rgba(255,0,51,0.95);}100%{text-shadow:0 0 6px rgba(255,0,51,0.5);}}
.container{padding:20px; max-width:1080px; margin:auto;}
.table{width:100%; border-collapse:collapse;margin-top:20px;}
.table th, .table td{padding:12px;border:1px solid rgba(255,0,51,0.2); text-align:center;}
.table th{background:rgba(255,0,51,0.05);}
.online{color:var(--neon-green); font-weight:700;}
.offline{color:var(--neon); font-weight:700;}
.btn{padding:10px 14px;border-radius:10px;border:1px solid rgba(255,0,51,0.2);cursor:pointer;background:linear-gradient(180deg, rgba(255,0,51,0.06), rgba(255,0,51,0.01));color:#fff;font-weight:700;margin-bottom:10px;}
.btn:hover{box-shadow:0 0 30px rgba(255,0,51,0.5);}
.notice{margin-top:10px;padding:10px;border-radius:8px;background:rgba(0,0,0,0.4);border:1px solid rgba(255,0,51,0.06);color:#fff;text-align:center;display:none;}
</style>
</head>
<body>
<h1>ADMIN CONTROL PANEL</h1>
<div class="container">
<button class="btn" onclick="goHome()">Go to Website</button>
<div class="notice" id="notice"></div>
<table class="table">
  <thead>
    <tr>
      <th>Email</th>
      <th>Passcode</th>
      <th>Signup Time</th>
      <th>Online Status</th>
      <th>Last Online</th>
    </tr>
  </thead>
  <tbody id="usersTable"></tbody>
</table>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-app.js";
import { getFirestore, collection, getDocs, doc, onSnapshot } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyCZ-kcVeGKjiQh4wgOe5yp-S9zxS8n3oZY",
  authDomain: "ironbro26-708c4.firebaseapp.com",
  projectId: "ironbro26-708c4",
  storageBucket: "ironbro26-708c4.firebasestorage.app",
  messagingSenderId: "47778309159",
  appId: "1:47778309159:web:0caea70db87468ca959a02",
  measurementId: "G-RWTEX313PX"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const OWNER_EMAIL="Krfuchs@icloud.com";

function showNotice(msg){
  const n=document.getElementById('notice');
  n.style.display="block";
  n.textContent=msg;
  setTimeout(()=>{n.style.display="none";},2000);
}

function goHome(){window.location.href="https://ironbro26fanclub.co.za/index.html";}

// Check if owner is logged in
const currentOwner = localStorage.getItem('currentOwner');
if(!currentOwner || currentOwner !== OWNER_EMAIL){
  alert("Access Denied: Admins Only.");
  window.location.href="signup.html";
}

// Realtime listener for users
const usersRef = collection(db,'users');
onSnapshot(usersRef, (snapshot)=>{
  const tbody=document.getElementById('usersTable');
  tbody.innerHTML="";
  snapshot.forEach(docSnap=>{
    const u=docSnap.data();
    const tr=document.createElement('tr');

    const emailTd=document.createElement('td'); emailTd.textContent=u.email; tr.appendChild(emailTd);
    const passTd=document.createElement('td'); passTd.textContent='*****'; tr.appendChild(passTd);
    const signupTd=document.createElement('td'); signupTd.textContent=new Date(u.signupTime).toLocaleString(); tr.appendChild(signupTd);
    const onlineTd=document.createElement('td'); onlineTd.textContent=u.online?'Online':'Offline'; onlineTd.className=u.online?'online':'offline'; tr.appendChild(onlineTd);
    const lastTd=document.createElement('td'); lastTd.textContent=new Date(u.lastOnline).toLocaleString(); tr.appendChild(lastTd);

    tbody.appendChild(tr);
  });
});
</script>
</body>
</html>
