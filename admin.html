<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Panel - IronBro26</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
<!-- Vercel Analytics -->
<script defer src="/_vercel/insights/script.js"></script>
<style>
  body {
    background:#0d0d0d;
    color:#fff;
    font-family:Arial,sans-serif;
    margin:0;
    padding:20px;
  }
  h1 { 
    color:#ff1a1a; 
    text-shadow:0 0 10px #ff3333, 0 0 25px #ff6666; 
  }
  a.home-btn {
    display:inline-block;
    padding:10px 20px;
    background:#ff1a1a;
    color:#000;
    font-weight:bold;
    border-radius:8px;
    text-decoration:none;
    box-shadow:0 0 15px #ff4444, 0 0 25px #ff6666;
    margin:15px 0 25px;
    transition:0.3s;
  }
  a.home-btn:hover {
    background:#ff3333;
    box-shadow:0 0 25px #ff6666,0 0 40px #ff9999;
    transform:scale(1.05);
  }
  table {
    width:100%;
    border-collapse:collapse;
    margin-top:10px;
  }
  th, td {
    border:1px solid #ff1a1a;
    padding:10px;
    text-align:left;
  }
  th { background:#ff1a1a; color:#000; }
  td { background:#222; }
  #accentStatus { font-size:13px; color:#aaa; }
</style>
</head>
<body>

<h1>üõ° Admin Panel</h1>
<a href="index.html" class="home-btn">üè† Go to Home Page</a>

<!-- Accent color picker -->
<div style="margin:18px 0;padding:12px;border-radius:10px;background:linear-gradient(180deg,#0b0b0b,#141414);border:1px solid rgba(255,255,255,0.04);max-width:520px">
  <label for="siteAccentPicker" style="display:block;margin-bottom:8px;color:#ccc;font-weight:600">Site Accent Color (updates sidebars)</label>
  <input id="siteAccentPicker" type="color" value="#ff1a1a" style="width:56px;height:40px;border:none;border-radius:6px;">
  <button id="applyAccent" style="margin-left:12px;padding:8px 12px;border-radius:8px;background:#222;color:#fff;border:1px solid #444;cursor:pointer">Apply</button>
  <button id="previewAccent" style="margin-left:8px;padding:8px 12px;border-radius:8px;background:#222;color:#fff;border:1px solid #444;cursor:pointer">Preview</button>
  <button id="resetAccent" style="margin-left:8px;padding:8px 12px;border-radius:8px;background:#222;color:#fff;border:1px solid #444;cursor:pointer">Reset</button>
  <div id="accentStatus"></div>
</div>

<!-- Users Table -->
<h2>Signed Up Users</h2>
<table id="usersTable">
  <tr>
    <th>Email</th>
    <th>Password</th>
    <th>Signed Up At</th>
  </tr>
</table>

<!-- Online Users Table -->
<h2>Currently Online Users</h2>
<table id="onlineTable">
  <tr>
    <th>Email</th>
    <th>Last Active</th>
  </tr>
</table>

<script>
  // Access Control
  const currentUser = JSON.parse(localStorage.getItem("currentUser"));
  if(!currentUser || currentUser.email !== "Krfuchs11@icloud.com") {
    alert("Access Denied! Only the owner can access this page.");
    window.location.href = "signup.html";
  }

  // Load all registered users
  const usersTable = document.getElementById("usersTable");
  const allUsers = JSON.parse(localStorage.getItem("users") || "[]");

  allUsers.forEach(user => {
    let row = usersTable.insertRow();
    row.insertCell(0).innerText = user.email;
    row.insertCell(1).innerText = user.password;
    row.insertCell(2).innerText = user.timestamp || "N/A";
  });

  // Online user tracking
  const onlineTable = document.getElementById("onlineTable");
  let onlineUsers = JSON.parse(localStorage.getItem("onlineUsers") || "[]");

  const now = new Date().toLocaleString();
  const existing = onlineUsers.find(u => u.email === currentUser.email);
  if (!existing) {
    onlineUsers.push({ email: currentUser.email, lastActive: now });
  } else {
    existing.lastActive = now;
  }
  localStorage.setItem("onlineUsers", JSON.stringify(onlineUsers));

  // Render online users
  function renderOnline() {
    onlineTable.innerHTML = "<tr><th>Email</th><th>Last Active</th></tr>";
    onlineUsers.forEach(u => {
      let row = onlineTable.insertRow();
      row.insertCell(0).innerText = u.email;
      row.insertCell(1).innerText = u.lastActive;
    });
  }
  renderOnline();

  // Remove user when tab closes
  window.addEventListener("beforeunload", () => {
    onlineUsers = onlineUsers.filter(u => u.email !== currentUser.email);
    localStorage.setItem("onlineUsers", JSON.stringify(onlineUsers));
  });

  // Accent color system
  document.addEventListener('DOMContentLoaded', function(){
    const picker = document.getElementById('siteAccentPicker');
    const applyBtn = document.getElementById('applyAccent');
    const previewBtn = document.getElementById('previewAccent');
    const resetBtn = document.getElementById('resetAccent');
    const status = document.getElementById('accentStatus');

    const savedAccent = localStorage.getItem('siteAccent');
    if (savedAccent) picker.value = savedAccent;

    function broadcastAccent(accent, preview) {
      if (accent) {
        localStorage.setItem('siteAccent', accent);
        status.textContent = 'Accent set to ' + accent;
      } else {
        localStorage.removeItem('siteAccent');
        status.textContent = 'Accent reset to default';
      }
      if (preview) {
        const win = window.open('./index.html', 'site-preview');
        if (win) win.focus();
      }
    }

    applyBtn.addEventListener('click', () => broadcastAccent(picker.value, false));
    previewBtn.addEventListener('click', () => broadcastAccent(picker.value, true));
    resetBtn.addEventListener('click', () => broadcastAccent(null, false));
  });
</script>


</body>
</html>
