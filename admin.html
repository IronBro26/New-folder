<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ADMIN CONTROL PANEL â€” ironbro26fanclub</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Audiowide&display=swap" rel="stylesheet">
<style>
:root{--bg:#000;--neon:#ff0033;--neon-green:#00ff88;}
*{box-sizing:border-box} 
html,body{height:100%;margin:0;background:var(--bg);color:var(--neon);font-family:'Orbitron',sans-serif}
canvas#sparks{position:fixed; inset:0; z-index:0; pointer-events:none}
.container{position:relative; z-index:1; min-height:100vh; display:flex; flex-direction:column; align-items:center; justify-content:flex-start; padding:32px}
.header{font-family:'Audiowide','Orbitron'; font-size:36px; margin:20px 0; text-shadow:0 0 12px rgba(255,0,51,0.9),0 0 40px rgba(255,0,51,0.14); animation:pulse 2s infinite ease-in-out;}
@keyframes pulse{0%{text-shadow:0 0 6px rgba(255,0,51,0.5)}50%{text-shadow:0 0 22px rgba(255,0,51,0.95)}100%{text-shadow:0 0 6px rgba(255,0,51,0.5)}}
.table{width:100%; max-width:1080px; border-collapse:collapse; margin-top:20px;}
.table th,.table td{padding:12px 14px;border:1px solid rgba(255,0,51,0.16); text-align:center;}
.table th{background:rgba(255,0,51,0.05);}
.online{color:var(--neon-green); font-weight:700;}
.offline{color:var(--neon); font-weight:700;}
.btn{padding:10px 14px; border-radius:10px; border:1px solid rgba(255,0,51,0.12); cursor:pointer; font-weight:700; color:white; background:linear-gradient(180deg, rgba(255,0,51,0.06), rgba(255,0,51,0.01)); transition: all .24s ease;}
.btn:hover{box-shadow:0 30px 80px rgba(255,0,51,0.08); transform:translateY(-3px);}
</style>
</head>
<body>
<canvas id="sparks"></canvas>
<div class="container">
  <div class="header">ADMIN CONTROL PANEL</div>
  <button class="btn" onclick="goHome()">Home</button>
  <table class="table" id="usersTable">
    <thead><tr><th>Email</th><th>Passcode</th><th>Signup Time</th><th>Online Status</th><th>Last Online</th></tr></thead>
    <tbody></tbody>
  </table>
</div>

<script>
const JSONBIN_ID = "68f6570dae596e708f1f6daa";
const JSONBIN_KEY = "$2a$10$szwEmZ8N1E54bEC.rq/y5.u8Pg4rs2sMbdZMYjV3D2IfXLkI5i34u";
const OWNER_EMAIL = "Krfuchs@icloud.com";

function goHome(){ window.location.href="https://ironbro26fanclub.co.za/index.html"; }

function getCurrentUserRole(){
  return localStorage.getItem('currentUserRole') || "Member";
}

// Check if owner is logged in
if(getCurrentUserRole() !== "Owner"){
  alert("Access Denied: Admins Only.");
  window.location.href="signup.html";
}

async function fetchUsers(){
  const res = await fetch(`https://api.jsonbin.io/v3/b/${JSONBIN_ID}/latest`, {
    headers: { "X-Master-Key": JSONBIN_KEY }
  });
  const data = await res.json();
  return data.record.users || [];
}

async function updateTable(){
  const users = await fetchUsers();
  const tbody = document.querySelector('#usersTable tbody');
  tbody.innerHTML = "";
  users.forEach(u=>{
    const tr=document.createElement('tr');
    const emailTd=document.createElement('td'); emailTd.textContent=u.email; tr.appendChild(emailTd);
    const passTd=document.createElement('td'); passTd.textContent='*****'; tr.appendChild(passTd);
    const signupTd=document.createElement('td'); signupTd.textContent=new Date(u.signupTime).toLocaleString(); tr.appendChild(signupTd);
    const onlineTd=document.createElement('td'); onlineTd.textContent=u.online?'Online':'Offline'; onlineTd.className=u.online?'online':'offline'; tr.appendChild(onlineTd);
    const lastTd=document.createElement('td'); lastTd.textContent=new Date(u.lastOnline).toLocaleString(); tr.appendChild(lastTd);
    tbody.appendChild(tr);
  });
}

// Update every 5 seconds to mimic real-time
updateTable();
setInterval(updateTable, 5000);

// Sparks background
const canvas = document.getElementById('sparks');
const ctx = canvas.getContext('2d');
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;
const sparks = [];
for(let i=0;i<100;i++){sparks.push({x:Math.random()*canvas.width,y:Math.random()*canvas.height,vx:(Math.random()-0.5)*0.5,vy:(Math.random()-0.5)*0.5,r:Math.random()*2+1})}
function animate(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  sparks.forEach(s=>{
    s.x+=s.vx; s.y+=s.vy;
    if(s.x<0||s.x>canvas.width)s.vx*=-1;
    if(s.y<0||s.y>canvas.height)s.vy*=-1;
    ctx.beginPath(); ctx.arc(s.x,s.y,s.r,0,Math.PI*2); ctx.fillStyle='rgba(255,0,51,0.7)'; ctx.fill();
  });
  requestAnimationFrame(animate);
}
animate();
window.addEventListener('resize',()=>{canvas.width=window.innerWidth; canvas.height=window.innerHeight;});
</script>
</body>
</html>
